<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sys_role">

    <select id="getRolesByUserName" resultType="String" parameterType="String">
        select sr.role_flag from sys_user_role sur
        left join sys_role sr on sr.kid = sur.role_id
        where sur.user_id = #{userId}
        union all
        select sm.permission from (select distinct srm.menu_id from sys_role_menu srm where srm.role_id in (
        select sr.kid from sys_user_role sur
        left join sys_role sr on sr.kid = sur.role_id
        where sur.user_id = #{userId}
        )) ltb,sys_menu sm where sm.kid = ltb.menu_id
    </select>

</mapper>